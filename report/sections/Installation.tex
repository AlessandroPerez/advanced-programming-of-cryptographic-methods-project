\chapter{Installation and Configuration}
\label{cha:Installation}

\section{Getting Started}

\begin{enumerate}
    \item Clone the repository:

        \begin{lstlisting}
git clone https://github.com/christiansassi/advanced-programming-of-cryptographic-methods-project
        \end{lstlisting}

    \item Navigate to the project directory:
    
        \begin{lstlisting}
cd advanced-programming-of-cryptographic-methods-project
        \end{lstlisting}
\end{enumerate}

\section{Configuration}

Modify the \href{https://github.com/christiansassi/advanced-programming-of-cryptographic-methods-project/blob/main/config/config.toml}{\texttt{config.toml}} file located in the \href{https://github.com/christiansassi/advanced-programming-of-cryptographic-methods-project/blob/main/config}{\texttt{config}} directory to adjust the application settings:

\begin{itemize}
    \item \texttt{server\_ip}: The IP address of the server (default: \texttt{server}). If you do not plan to use Docker (see Section~\ref{sec:source} and/or Section~\ref{sec:python}), set this to \texttt{"127.0.0.1"} or another valid IP address.
    \item \texttt{server\_port}: The port on which the server listens (default: \texttt{3333}).
    \item \texttt{log\_level}: The logging level (default: \texttt{info}).
\end{itemize}

\noindent
\begin{myWarning}
\textbf{Warning:} Do not modify \texttt{private\_key\_server} and \texttt{public\_key\_server}. These values are automatically generated when the server starts.
\end{myWarning}

\section{Installation}

You can choose between installing the project using Docker (the default and recommended method), using the pre-built executables with Python as a launcher, or building the executables yourself.  
The Docker-based method is recommended, as it minimizes compatibility issues by encapsulating all dependencies within containers.  
The local installation is less user-friendly, especially on macOS (see the warning in Section~\ref{sec:python}), as it \textit{may} require manually building the source files.  
However, all methods provide the same functionality. Choose the installation method that best fits your environment and preferences.

\subsection{Installation with Docker (Recommended)}
\label{sec:docker}

\begin{enumerate}
    \item Verify that Docker is installed by running:

        \begin{lstlisting}
docker --version
        \end{lstlisting}

    \item Build the Docker image:

        \begin{lstlisting}
docker compose build --no-cache
        \end{lstlisting}

    \item Run the updater to generate server keys:

        \begin{lstlisting}
docker compose run --rm updater
        \end{lstlisting}

    \item Start the server and clients:

        \begin{lstlisting}
docker compose up server client1 client2
        \end{lstlisting}

    \item Open a new terminal and attach to the TUI of \texttt{client1}:

        \begin{lstlisting}
docker container attach client1
        \end{lstlisting}

    \item Repeat the previous step for \texttt{client2}, if desired.

    \item To stop the containers, press \texttt{CTRL+C} in the terminal where you ran \texttt{docker compose up}, or run \texttt{docker compose down}.

\end{enumerate}

\subsection{Local Installation from Source}
\label{sec:source}

\begin{enumerate}
    \item Ensure that Rust and Cargo are installed by running:
    
    \begin{lstlisting}
rustc --version
cargo --version
    \end{lstlisting}
    
    \item Build the server:
    
    From the root of the repository:
    
    \begin{enumerate}
        \item Navigate to the \href{https://github.com/christiansassi/advanced-programming-of-cryptographic-methods-project/tree/main/server}{\texttt{server}} directory:
        
        \begin{lstlisting}
cd server
        \end{lstlisting}
        
        \item Build the server source files:
        
        \begin{lstlisting}
cargo build --release
        \end{lstlisting}
    \end{enumerate}
    
    \item Build the TUI:
    
    From the root of the repository:
    
    \begin{enumerate}
        \item Navigate to the \href{https://github.com/christiansassi/advanced-programming-of-cryptographic-methods-project/tree/main/tui}{\texttt{tui}} directory:
        
        \begin{lstlisting}
cd tui
        \end{lstlisting}
        
        \item Build the TUI source files:
        
        \begin{lstlisting}
cargo build --release
        \end{lstlisting}
    \end{enumerate}
    
    \item You can run the compiled executables located in the \texttt{release} subdirectory of both the \href{https://github.com/christiansassi/advanced-programming-of-cryptographic-methods-project/tree/main/server/target/release}{\texttt{server}} and \href{https://github.com/christiansassi/advanced-programming-of-cryptographic-methods-project/tree/main/tui/target/release}{\texttt{tui}} directories.
\end{enumerate}

\subsection{Python Launcher (No Installation Required)}
\label{sec:python}

\noindent
\begin{myWarning}
\textbf{Warning:} With this installation method, you will use pre-built executables. If you are using macOS, please follow the instructions in Section~\ref{sec:source}, as no pre-built executable is provided. If you are using another platform (e.g., Windows or Linux) and encounter issues, you can also refer to Section~\ref{sec:source}. Once you have successfully built the executables, you can return to this section.
\end{myWarning}

\begin{enumerate}
    \item Ensure Python is installed by running:

        \begin{lstlisting}
python --version
        \end{lstlisting}

    There is no specific Python version or dependency requirement, as Python is only used to simplify the launching process.

    \item Run the server:

        \begin{lstlisting}
python server.py
        \end{lstlisting}

    \item Run one or more clients:

        \begin{lstlisting}
python tui.py
        \end{lstlisting}
\end{enumerate}
